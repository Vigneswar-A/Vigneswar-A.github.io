SELECT SUM(APPLES) APPLE_COUNT, SUM(ORANGES) ORANGE_COUNT FROM (SELECT SUM(B.APPLE_COUNT)+NVL(SUM(C.APPLE_COUNT), 0) APPLES, SUM(B.ORANGE_COUNT)+NVL(SUM(C.ORANGE_COUNT), 0) ORANGES FROM (BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) GROUP BY B.BOX_ID, B.CHEST_ID)